/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/torch/nn/modules/rnn.py:70: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at albert-large-v2 were not used when initializing AlbertModel: ['predictions.LayerNorm.weight', 'predictions.decoder.bias', 'predictions.dense.bias', 'predictions.decoder.weight', 'predictions.dense.weight', 'predictions.bias', 'predictions.LayerNorm.bias']
- This IS expected if you are initializing AlbertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing AlbertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Warn: we adopt CRF implemented by allennlp, please install it first before using CRF.
{'main_dual': {'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'save_dir': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/', 'num_iter': 5, 'data_name': 'fewrel', 'split': 'unseen_15_seed_3', 'type': 'synthetic', 'model_size': 'large', 'with_train': False, 'by_rel': False, 'rl_version': 'all', 'rescale_train': False, 'score_only_ext': True, 'limit': 5000, 'g_encoder_name': 'generate', 'num_gen_per_label': 500, 'diverse': False}}
{'estimate': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/0.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/0_ext.jsonl'}}
{'filter_data_nb_rel': {'path_pseudo': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/0_ext.jsonl', 'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/0.jsonl', 'total_pseudo_per_label': 500, 'pseudo_ratio': 0.2, 'with_train': False, 'by_rel': False, 'version': 'all', 'rescale_train': False}}
fit {'path_train': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/0.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl'}
{'select_model': RelationGenerator(model_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter1/model', data_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter1/data', model_name='outputs/wrapper/fewrel/unseen_15_seed_3/generator/model', do_pretrain=False, encoder_name='generate', pipe_name='text-generation', batch_size=32, grad_accumulation=2, random_seed=42, warmup_ratio=0.2, lr_pretrain=0.0003, lr_finetune=3e-05, epochs_pretrain=3, epochs_finetune=5, train_fp16=True, block_size=128)}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter1', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'labels': ['has part', 'location', 'member of political party', 'platform', 'position held'], 'mode': 'all_single', 'model_size': 'large', 'is_eval': True, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter1', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'single', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter1', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'multi', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'estimate': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/1.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/1_ext.jsonl'}}
{'filter_data_nb_rel': {'path_pseudo': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/1_ext.jsonl', 'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/1.jsonl', 'total_pseudo_per_label': 500, 'pseudo_ratio': 0.4, 'with_train': False, 'by_rel': False, 'version': 'all', 'rescale_train': False}}
fit {'path_train': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/1.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl'}
{'select_model': RelationGenerator(model_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter2/model', data_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter2/data', model_name='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter1/model', do_pretrain=False, encoder_name='generate', pipe_name='text-generation', batch_size=32, grad_accumulation=2, random_seed=42, warmup_ratio=0.2, lr_pretrain=0.0003, lr_finetune=3e-05, epochs_pretrain=3, epochs_finetune=5, train_fp16=True, block_size=128)}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter2', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'labels': ['has part', 'location', 'member of political party', 'platform', 'position held'], 'mode': 'all_single', 'model_size': 'large', 'is_eval': True, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter2', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'single', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter2', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'multi', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'estimate': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/2.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/2_ext.jsonl'}}
{'filter_data_nb_rel': {'path_pseudo': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/2_ext.jsonl', 'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/2.jsonl', 'total_pseudo_per_label': 500, 'pseudo_ratio': 0.6, 'with_train': False, 'by_rel': False, 'version': 'all', 'rescale_train': False}}
fit {'path_train': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/2.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl'}
{'select_model': RelationGenerator(model_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter3/model', data_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter3/data', model_name='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter2/model', do_pretrain=False, encoder_name='generate', pipe_name='text-generation', batch_size=32, grad_accumulation=2, random_seed=42, warmup_ratio=0.2, lr_pretrain=0.0003, lr_finetune=3e-05, epochs_pretrain=3, epochs_finetune=5, train_fp16=True, block_size=128)}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter3', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'labels': ['has part', 'location', 'member of political party', 'platform', 'position held'], 'mode': 'all_single', 'model_size': 'large', 'is_eval': True, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter3', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'single', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter3', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'multi', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'estimate': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/3.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/3_ext.jsonl'}}
{'filter_data_nb_rel': {'path_pseudo': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/3_ext.jsonl', 'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/3.jsonl', 'total_pseudo_per_label': 500, 'pseudo_ratio': 0.8, 'with_train': False, 'by_rel': False, 'version': 'all', 'rescale_train': False}}
fit {'path_train': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/3.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl'}
{'select_model': RelationGenerator(model_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter4/model', data_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter4/data', model_name='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter3/model', do_pretrain=False, encoder_name='generate', pipe_name='text-generation', batch_size=32, grad_accumulation=2, random_seed=42, warmup_ratio=0.2, lr_pretrain=0.0003, lr_finetune=3e-05, epochs_pretrain=3, epochs_finetune=5, train_fp16=True, block_size=128)}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter4', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'labels': ['has part', 'location', 'member of political party', 'platform', 'position held'], 'mode': 'all_single', 'model_size': 'large', 'is_eval': True, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter4', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'single', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter4', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'multi', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'estimate': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/4.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/4_ext.jsonl'}}
{'filter_data_nb_rel': {'path_pseudo': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/synthetic/4_ext.jsonl', 'path_train': 'zero_rte/fewrel/unseen_15_seed_3/train.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/4.jsonl', 'total_pseudo_per_label': 500, 'pseudo_ratio': 1.0, 'with_train': False, 'by_rel': False, 'version': 'all', 'rescale_train': False}}
fit {'path_train': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/filtered/4.jsonl', 'path_dev': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl'}
{'select_model': RelationGenerator(model_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter5/model', data_dir='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter5/data', model_name='outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/generator/iter4/model', do_pretrain=False, encoder_name='generate', pipe_name='text-generation', batch_size=32, grad_accumulation=2, random_seed=42, warmup_ratio=0.2, lr_pretrain=0.0003, lr_finetune=3e-05, epochs_pretrain=3, epochs_finetune=5, train_fp16=True, block_size=128)}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/dev.jsonl', 'labels': ['has part', 'location', 'member of political party', 'platform', 'position held'], 'mode': 'all_single', 'model_size': 'large', 'is_eval': True, 'limit': 0}}
{'predict': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_all_single_is_eval_True.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_all_single_is_eval_True.jsonl'}}
predict vocab size: 13258
{'get_model': {'config': {'cased': False, 'token_emb_dim': 100, 'char_encoder': 'lstm', 'char_emb_dim': 30, 'tag_emb_dim': 50, 'hidden_dim': 200, 'num_layers': 3, 'max_depth': None, 'crf': None, 'loss_reduction': 'sum', 'dropout': 0.5, 'lr': 0.001, 'optimizer': 'adam', 'maxlen': None, 'vocab_size': 13358, 'vocab_file': None, 'ner_tag_vocab_size': 64, 're_tag_vocab_size': 250, 'tag_form': 'iob2', 'device': 'cuda', 'lm_emb_dim': 1024, 'lm_emb_path': 'albert-large-v2', 'pos_emb_dim': 0, 'head_emb_dim': 384, 'warm_steps': 1000, 'grad_period': 1}}}
albert-large-v2 is not file, try load as bert model.
albert-large-v2 loaded successfully.
Note it only supports default options now, i.e.: 
  layers='-1,-2,-3,-4', use_scalar_mix=True, pooling_operation="mean"
reading pretrained wv from outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/data/predict.txt
Extractor Predicting: 0it [00:00, ?it/s]/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/torch/nn/modules/module.py:1190: UserWarning: operator() sees varying value in profiling, ignoring and this should be handled by GUARD logic (Triggered internally at ../torch/csrc/jit/codegen/cuda/parser.cpp:3668.)
  return forward_call(*input, **kwargs)
/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/torch/nn/modules/module.py:1190: UserWarning: operator() profile_node %91 : int[] = prim::profile_ivalue[profile_failed="varying profile values"](%89)
 does not have profile information (Triggered internally at ../torch/csrc/jit/codegen/cuda/graph_fuser.cpp:105.)
  return forward_call(*input, **kwargs)
Extractor Predicting: 1it [00:32, 32.80s/it]Extractor Predicting: 2it [00:34, 14.23s/it]Extractor Predicting: 3it [00:34,  8.00s/it]Extractor Predicting: 4it [00:35,  5.07s/it]Extractor Predicting: 5it [00:35,  3.45s/it]Extractor Predicting: 6it [00:36,  2.50s/it]Extractor Predicting: 7it [00:37,  1.88s/it]Extractor Predicting: 8it [00:37,  1.48s/it]Extractor Predicting: 9it [00:38,  1.20s/it]Extractor Predicting: 10it [00:38,  1.01it/s]Extractor Predicting: 11it [00:39,  1.15it/s]Extractor Predicting: 12it [00:39,  1.28it/s]Extractor Predicting: 13it [00:40,  1.31it/s]Extractor Predicting: 14it [00:41,  1.42it/s]Extractor Predicting: 15it [00:41,  1.44it/s]Extractor Predicting: 16it [00:42,  1.52it/s]Extractor Predicting: 17it [00:43,  1.58it/s]Extractor Predicting: 18it [00:43,  1.62it/s]Extractor Predicting: 19it [00:44,  1.60it/s]Extractor Predicting: 20it [00:44,  1.62it/s]Extractor Predicting: 21it [00:45,  1.64it/s]Extractor Predicting: 22it [00:46,  1.65it/s]Extractor Predicting: 23it [00:46,  1.67it/s]Extractor Predicting: 24it [00:47,  1.63it/s]Extractor Predicting: 25it [00:47,  1.65it/s]Extractor Predicting: 26it [00:48,  1.66it/s]Extractor Predicting: 27it [00:49,  1.69it/s]Extractor Predicting: 28it [00:49,  1.66it/s]Extractor Predicting: 29it [00:50,  1.66it/s]Extractor Predicting: 30it [00:50,  1.69it/s]Extractor Predicting: 31it [00:51,  1.69it/s]Extractor Predicting: 32it [00:52,  1.67it/s]Extractor Predicting: 33it [00:52,  1.72it/s]Extractor Predicting: 34it [00:53,  1.73it/s]Extractor Predicting: 35it [00:53,  1.69it/s]Extractor Predicting: 36it [00:54,  1.67it/s]Extractor Predicting: 37it [00:54,  1.66it/s]Extractor Predicting: 38it [00:55,  1.65it/s]Extractor Predicting: 39it [00:56,  1.64it/s]Extractor Predicting: 40it [00:56,  1.65it/s]Extractor Predicting: 41it [00:57,  1.59it/s]Extractor Predicting: 42it [00:58,  1.61it/s]Extractor Predicting: 43it [00:58,  1.62it/s]Extractor Predicting: 44it [00:59,  1.61it/s]Extractor Predicting: 45it [00:59,  1.61it/s]Extractor Predicting: 46it [01:00,  1.64it/s]Extractor Predicting: 47it [01:01,  1.63it/s]Extractor Predicting: 48it [01:01,  1.62it/s]Extractor Predicting: 49it [01:02,  1.60it/s]Extractor Predicting: 50it [01:03,  1.60it/s]Extractor Predicting: 51it [01:03,  1.61it/s]Extractor Predicting: 52it [01:04,  1.58it/s]Extractor Predicting: 53it [01:04,  1.60it/s]Extractor Predicting: 54it [01:05,  1.60it/s]Extractor Predicting: 55it [01:06,  1.58it/s]Extractor Predicting: 56it [01:06,  1.61it/s]Extractor Predicting: 57it [01:07,  1.56it/s]Extractor Predicting: 58it [01:08,  1.58it/s]Extractor Predicting: 59it [01:08,  1.57it/s]Extractor Predicting: 60it [01:09,  1.58it/s]Extractor Predicting: 61it [01:09,  1.60it/s]Extractor Predicting: 62it [01:10,  1.64it/s]Extractor Predicting: 63it [01:11,  1.66it/s]Extractor Predicting: 64it [01:11,  1.64it/s]Extractor Predicting: 65it [01:12,  1.65it/s]Extractor Predicting: 66it [01:12,  1.65it/s]Extractor Predicting: 67it [01:13,  1.67it/s]Extractor Predicting: 68it [01:14,  1.66it/s]Extractor Predicting: 69it [01:14,  1.69it/s]Extractor Predicting: 70it [01:15,  1.72it/s]Extractor Predicting: 71it [01:15,  1.72it/s]Extractor Predicting: 72it [01:16,  1.71it/s]Extractor Predicting: 73it [01:17,  1.71it/s]Extractor Predicting: 74it [01:17,  1.70it/s]Extractor Predicting: 75it [01:18,  1.66it/s]Extractor Predicting: 76it [01:18,  1.65it/s]Extractor Predicting: 77it [01:19,  1.68it/s]Extractor Predicting: 78it [01:20,  1.71it/s]Extractor Predicting: 79it [01:20,  1.71it/s]Extractor Predicting: 80it [01:21,  1.72it/s]Extractor Predicting: 81it [01:21,  1.72it/s]Extractor Predicting: 82it [01:22,  1.74it/s]Extractor Predicting: 83it [01:22,  1.71it/s]Extractor Predicting: 84it [01:23,  1.68it/s]Extractor Predicting: 85it [01:24,  1.71it/s]Extractor Predicting: 86it [01:24,  1.65it/s]Extractor Predicting: 87it [01:25,  1.54it/s]Extractor Predicting: 88it [01:26,  1.59it/s]Extractor Predicting: 89it [01:26,  1.61it/s]Extractor Predicting: 90it [01:27,  1.65it/s]Extractor Predicting: 91it [01:27,  1.64it/s]Extractor Predicting: 92it [01:28,  1.61it/s]Extractor Predicting: 93it [01:29,  1.63it/s]Extractor Predicting: 94it [01:29,  1.65it/s]Extractor Predicting: 95it [01:30,  1.64it/s]Extractor Predicting: 96it [01:30,  1.64it/s]Extractor Predicting: 97it [01:31,  1.65it/s]Extractor Predicting: 98it [01:32,  1.70it/s]Extractor Predicting: 99it [01:32,  1.67it/s]Extractor Predicting: 100it [01:33,  1.62it/s]Extractor Predicting: 101it [01:33,  1.66it/s]Extractor Predicting: 102it [01:34,  1.65it/s]Extractor Predicting: 103it [01:35,  1.63it/s]Extractor Predicting: 104it [01:35,  1.65it/s]Extractor Predicting: 105it [01:36,  1.65it/s]Extractor Predicting: 106it [01:37,  1.64it/s]Extractor Predicting: 107it [01:37,  1.67it/s]Extractor Predicting: 108it [01:38,  1.67it/s]Extractor Predicting: 109it [01:38,  1.62it/s]Extractor Predicting: 110it [01:39,  1.62it/s]Extractor Predicting: 111it [01:40,  1.62it/s]Extractor Predicting: 112it [01:40,  1.63it/s]Extractor Predicting: 113it [01:41,  1.64it/s]Extractor Predicting: 114it [01:41,  1.65it/s]Extractor Predicting: 115it [01:42,  1.64it/s]Extractor Predicting: 116it [01:43,  1.64it/s]Extractor Predicting: 117it [01:43,  1.65it/s]Extractor Predicting: 118it [01:44,  1.66it/s]Extractor Predicting: 119it [01:44,  1.70it/s]Extractor Predicting: 120it [01:45,  1.75it/s]Extractor Predicting: 121it [01:45,  1.75it/s]Extractor Predicting: 122it [01:46,  1.75it/s]Extractor Predicting: 123it [01:47,  1.71it/s]Extractor Predicting: 124it [01:47,  1.71it/s]Extractor Predicting: 125it [01:48,  1.70it/s]Extractor Predicting: 126it [01:48,  1.70it/s]Extractor Predicting: 127it [01:49,  1.70it/s]Extractor Predicting: 128it [01:50,  1.67it/s]Extractor Predicting: 129it [01:50,  1.72it/s]Extractor Predicting: 130it [01:51,  1.67it/s]Extractor Predicting: 131it [01:51,  1.68it/s]Extractor Predicting: 132it [01:52,  1.69it/s]Extractor Predicting: 133it [01:53,  1.67it/s]Extractor Predicting: 134it [01:53,  1.63it/s]Extractor Predicting: 135it [01:54,  1.67it/s]Extractor Predicting: 136it [01:54,  1.69it/s]Extractor Predicting: 137it [01:55,  1.62it/s]Extractor Predicting: 138it [01:56,  1.62it/s]Extractor Predicting: 139it [01:56,  1.66it/s]Extractor Predicting: 140it [01:57,  1.66it/s]Extractor Predicting: 141it [01:57,  1.67it/s]Extractor Predicting: 142it [01:58,  1.62it/s]Extractor Predicting: 143it [01:59,  1.65it/s]Extractor Predicting: 144it [01:59,  1.67it/s]Extractor Predicting: 145it [02:00,  1.29it/s]Extractor Predicting: 145it [02:00,  1.20it/s]
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at albert-large-v2 were not used when initializing AlbertModel: ['predictions.LayerNorm.weight', 'predictions.decoder.bias', 'predictions.dense.bias', 'predictions.decoder.weight', 'predictions.dense.weight', 'predictions.bias', 'predictions.LayerNorm.bias']
- This IS expected if you are initializing AlbertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing AlbertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
{
  "path_pred": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_all_single_is_eval_True.jsonl",
  "path_gold": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_all_single_is_eval_True.jsonl",
  "precision": 0.3614117647058824,
  "recall": 0.22012037833190026,
  "score": 0.27360171001068756,
  "mode": "all_single",
  "limit": 0,
  "path_results": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/results_all_single_is_eval_True.json"
}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'single', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'predict': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_single_is_eval_False.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_single_is_eval_False.jsonl'}}
predict vocab size: 25753
{'get_model': {'config': {'cased': False, 'token_emb_dim': 100, 'char_encoder': 'lstm', 'char_emb_dim': 30, 'tag_emb_dim': 50, 'hidden_dim': 200, 'num_layers': 3, 'max_depth': None, 'crf': None, 'loss_reduction': 'sum', 'dropout': 0.5, 'lr': 0.001, 'optimizer': 'adam', 'maxlen': None, 'vocab_size': 25853, 'vocab_file': None, 'ner_tag_vocab_size': 64, 're_tag_vocab_size': 250, 'tag_form': 'iob2', 'device': 'cuda', 'lm_emb_dim': 1024, 'lm_emb_path': 'albert-large-v2', 'pos_emb_dim': 0, 'head_emb_dim': 384, 'warm_steps': 1000, 'grad_period': 1}}}
albert-large-v2 is not file, try load as bert model.
albert-large-v2 loaded successfully.
Note it only supports default options now, i.e.: 
  layers='-1,-2,-3,-4', use_scalar_mix=True, pooling_operation="mean"
reading pretrained wv from outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/data/predict.txt
Extractor Predicting: 0it [00:00, ?it/s]Extractor Predicting: 1it [00:00,  1.79it/s]Extractor Predicting: 2it [00:01,  1.76it/s]Extractor Predicting: 3it [00:01,  1.72it/s]Extractor Predicting: 4it [00:02,  1.69it/s]Extractor Predicting: 5it [00:02,  1.66it/s]Extractor Predicting: 6it [00:03,  1.67it/s]Extractor Predicting: 7it [00:04,  1.68it/s]Extractor Predicting: 8it [00:04,  1.67it/s]Extractor Predicting: 9it [00:05,  1.69it/s]Extractor Predicting: 10it [00:05,  1.66it/s]Extractor Predicting: 11it [00:06,  1.65it/s]Extractor Predicting: 12it [00:07,  1.66it/s]Extractor Predicting: 13it [00:07,  1.69it/s]Extractor Predicting: 14it [00:08,  1.69it/s]Extractor Predicting: 15it [00:08,  1.68it/s]Extractor Predicting: 16it [00:09,  1.65it/s]Extractor Predicting: 17it [00:10,  1.64it/s]Extractor Predicting: 18it [00:10,  1.65it/s]Extractor Predicting: 19it [00:11,  1.70it/s]Extractor Predicting: 20it [00:11,  1.68it/s]Extractor Predicting: 21it [00:12,  1.70it/s]Extractor Predicting: 22it [00:13,  1.75it/s]Extractor Predicting: 23it [00:13,  1.75it/s]Extractor Predicting: 24it [00:14,  1.70it/s]Extractor Predicting: 25it [00:14,  1.64it/s]Extractor Predicting: 26it [00:15,  1.68it/s]Extractor Predicting: 27it [00:16,  1.67it/s]Extractor Predicting: 28it [00:16,  1.65it/s]Extractor Predicting: 29it [00:17,  1.67it/s]Extractor Predicting: 30it [00:17,  1.62it/s]Extractor Predicting: 31it [00:18,  1.63it/s]Extractor Predicting: 32it [00:19,  1.62it/s]Extractor Predicting: 33it [00:19,  1.61it/s]Extractor Predicting: 34it [00:20,  1.62it/s]Extractor Predicting: 35it [00:20,  1.64it/s]Extractor Predicting: 36it [00:21,  1.67it/s]Extractor Predicting: 37it [00:22,  1.73it/s]Extractor Predicting: 38it [00:22,  1.72it/s]Extractor Predicting: 39it [00:23,  1.71it/s]Extractor Predicting: 40it [00:23,  1.72it/s]Extractor Predicting: 41it [00:24,  1.72it/s]Extractor Predicting: 42it [00:25,  1.69it/s]Extractor Predicting: 43it [00:25,  1.68it/s]Extractor Predicting: 44it [00:26,  1.70it/s]Extractor Predicting: 45it [00:26,  1.63it/s]Extractor Predicting: 46it [00:27,  1.65it/s]Extractor Predicting: 47it [00:28,  1.67it/s]Extractor Predicting: 48it [00:28,  1.67it/s]Extractor Predicting: 49it [00:29,  1.68it/s]Extractor Predicting: 50it [00:29,  1.62it/s]Extractor Predicting: 51it [00:30,  1.65it/s]Extractor Predicting: 52it [00:31,  1.66it/s]Extractor Predicting: 53it [00:31,  1.68it/s]Extractor Predicting: 54it [00:32,  1.69it/s]Extractor Predicting: 55it [00:32,  1.65it/s]Extractor Predicting: 56it [00:33,  1.66it/s]Extractor Predicting: 57it [00:34,  1.69it/s]Extractor Predicting: 58it [00:34,  1.71it/s]Extractor Predicting: 59it [00:35,  1.67it/s]Extractor Predicting: 60it [00:35,  1.77it/s]Extractor Predicting: 61it [00:36,  1.79it/s]Extractor Predicting: 62it [00:36,  1.83it/s]Extractor Predicting: 63it [00:37,  1.83it/s]Extractor Predicting: 64it [00:37,  1.87it/s]Extractor Predicting: 65it [00:38,  1.88it/s]Extractor Predicting: 66it [00:38,  1.87it/s]Extractor Predicting: 67it [00:39,  1.90it/s]Extractor Predicting: 68it [00:39,  1.88it/s]Extractor Predicting: 69it [00:40,  1.93it/s]Extractor Predicting: 70it [00:40,  1.92it/s]Extractor Predicting: 71it [00:41,  1.92it/s]Extractor Predicting: 72it [00:42,  1.76it/s]Extractor Predicting: 73it [00:42,  1.81it/s]Extractor Predicting: 74it [00:43,  1.83it/s]Extractor Predicting: 75it [00:43,  1.84it/s]Extractor Predicting: 76it [00:44,  1.90it/s]Extractor Predicting: 77it [00:44,  1.94it/s]Extractor Predicting: 78it [00:45,  1.85it/s]Extractor Predicting: 79it [00:45,  1.89it/s]Extractor Predicting: 80it [00:46,  1.91it/s]Extractor Predicting: 81it [00:46,  1.90it/s]Extractor Predicting: 82it [00:47,  1.90it/s]Extractor Predicting: 83it [00:47,  1.89it/s]Extractor Predicting: 84it [00:48,  1.88it/s]Extractor Predicting: 85it [00:49,  1.89it/s]Extractor Predicting: 86it [00:49,  1.83it/s]Extractor Predicting: 87it [00:50,  1.78it/s]Extractor Predicting: 88it [00:50,  1.73it/s]Extractor Predicting: 89it [00:51,  1.70it/s]Extractor Predicting: 90it [00:52,  1.65it/s]Extractor Predicting: 91it [00:52,  1.66it/s]Extractor Predicting: 92it [00:53,  1.63it/s]Extractor Predicting: 93it [00:53,  1.68it/s]Extractor Predicting: 94it [00:54,  1.66it/s]Extractor Predicting: 95it [00:55,  1.67it/s]Extractor Predicting: 96it [00:55,  1.62it/s]Extractor Predicting: 97it [00:56,  1.63it/s]Extractor Predicting: 98it [00:56,  1.63it/s]Extractor Predicting: 99it [00:57,  1.64it/s]Extractor Predicting: 100it [00:58,  1.64it/s]Extractor Predicting: 101it [00:58,  1.64it/s]Extractor Predicting: 102it [00:59,  1.63it/s]Extractor Predicting: 103it [00:59,  1.66it/s]Extractor Predicting: 104it [01:00,  1.60it/s]Extractor Predicting: 105it [01:01,  1.61it/s]Extractor Predicting: 106it [01:01,  1.59it/s]Extractor Predicting: 107it [01:02,  1.58it/s]Extractor Predicting: 108it [01:03,  1.58it/s]Extractor Predicting: 109it [01:03,  1.62it/s]Extractor Predicting: 110it [01:04,  1.61it/s]Extractor Predicting: 111it [01:05,  1.60it/s]Extractor Predicting: 112it [01:05,  1.57it/s]Extractor Predicting: 113it [01:06,  1.49it/s]Extractor Predicting: 114it [01:07,  1.56it/s]Extractor Predicting: 115it [01:07,  1.57it/s]Extractor Predicting: 116it [01:08,  1.61it/s]Extractor Predicting: 117it [01:08,  1.65it/s]Extractor Predicting: 118it [01:09,  1.60it/s]Extractor Predicting: 119it [01:10,  1.57it/s]Extractor Predicting: 120it [01:10,  1.59it/s]Extractor Predicting: 121it [01:11,  1.55it/s]Extractor Predicting: 122it [01:12,  1.58it/s]Extractor Predicting: 123it [01:12,  1.61it/s]Extractor Predicting: 124it [01:13,  1.61it/s]Extractor Predicting: 125it [01:13,  1.60it/s]Extractor Predicting: 126it [01:14,  1.57it/s]Extractor Predicting: 127it [01:15,  1.57it/s]Extractor Predicting: 128it [01:15,  1.55it/s]Extractor Predicting: 129it [01:16,  1.55it/s]Extractor Predicting: 130it [01:17,  1.55it/s]Extractor Predicting: 131it [01:17,  1.59it/s]Extractor Predicting: 132it [01:18,  1.59it/s]Extractor Predicting: 133it [01:18,  1.60it/s]Extractor Predicting: 134it [01:19,  1.62it/s]Extractor Predicting: 135it [01:20,  1.61it/s]Extractor Predicting: 136it [01:20,  1.57it/s]Extractor Predicting: 137it [01:21,  1.56it/s]Extractor Predicting: 138it [01:22,  1.56it/s]Extractor Predicting: 139it [01:22,  1.56it/s]Extractor Predicting: 140it [01:23,  1.58it/s]Extractor Predicting: 141it [01:24,  1.58it/s]Extractor Predicting: 142it [01:24,  1.59it/s]Extractor Predicting: 143it [01:25,  1.55it/s]Extractor Predicting: 144it [01:25,  1.56it/s]Extractor Predicting: 145it [01:26,  1.55it/s]Extractor Predicting: 146it [01:27,  1.56it/s]Extractor Predicting: 147it [01:27,  1.59it/s]Extractor Predicting: 148it [01:28,  1.63it/s]Extractor Predicting: 149it [01:29,  1.59it/s]Extractor Predicting: 150it [01:29,  1.59it/s]Extractor Predicting: 151it [01:30,  1.62it/s]Extractor Predicting: 152it [01:30,  1.65it/s]Extractor Predicting: 153it [01:31,  1.64it/s]Extractor Predicting: 154it [01:32,  1.67it/s]Extractor Predicting: 155it [01:32,  1.69it/s]Extractor Predicting: 156it [01:33,  1.72it/s]Extractor Predicting: 157it [01:33,  1.70it/s]Extractor Predicting: 158it [01:34,  1.72it/s]Extractor Predicting: 159it [01:34,  1.77it/s]Extractor Predicting: 160it [01:35,  1.71it/s]Extractor Predicting: 161it [01:36,  1.67it/s]Extractor Predicting: 162it [01:36,  1.59it/s]Extractor Predicting: 163it [01:37,  1.62it/s]Extractor Predicting: 164it [01:38,  1.61it/s]Extractor Predicting: 165it [01:38,  1.62it/s]Extractor Predicting: 166it [01:39,  1.63it/s]Extractor Predicting: 167it [01:39,  1.62it/s]Extractor Predicting: 168it [01:40,  1.62it/s]Extractor Predicting: 169it [01:41,  1.62it/s]Extractor Predicting: 170it [01:41,  1.62it/s]Extractor Predicting: 171it [01:42,  1.62it/s]Extractor Predicting: 172it [01:43,  1.60it/s]Extractor Predicting: 173it [01:43,  1.61it/s]Extractor Predicting: 174it [01:44,  1.62it/s]Extractor Predicting: 175it [01:44,  1.62it/s]Extractor Predicting: 176it [01:45,  1.62it/s]Extractor Predicting: 177it [01:46,  1.67it/s]Extractor Predicting: 178it [01:46,  1.63it/s]Extractor Predicting: 179it [01:47,  1.66it/s]Extractor Predicting: 180it [01:48,  1.51it/s]Extractor Predicting: 181it [01:48,  1.46it/s]Extractor Predicting: 182it [01:49,  1.56it/s]Extractor Predicting: 183it [01:49,  1.61it/s]Extractor Predicting: 184it [01:50,  1.63it/s]Extractor Predicting: 185it [01:51,  1.69it/s]Extractor Predicting: 186it [01:51,  1.70it/s]Extractor Predicting: 187it [01:52,  1.64it/s]Extractor Predicting: 188it [01:52,  1.71it/s]Extractor Predicting: 189it [01:53,  1.74it/s]Extractor Predicting: 190it [01:53,  1.79it/s]Extractor Predicting: 191it [01:54,  1.72it/s]Extractor Predicting: 192it [01:55,  1.75it/s]Extractor Predicting: 193it [01:55,  1.77it/s]Extractor Predicting: 194it [01:56,  1.81it/s]Extractor Predicting: 195it [01:56,  1.76it/s]Extractor Predicting: 196it [01:57,  1.74it/s]Extractor Predicting: 197it [01:57,  1.76it/s]Extractor Predicting: 198it [01:58,  1.74it/s]Extractor Predicting: 199it [01:59,  1.70it/s]Extractor Predicting: 200it [01:59,  1.72it/s]Extractor Predicting: 201it [02:00,  1.72it/s]Extractor Predicting: 202it [02:00,  1.76it/s]Extractor Predicting: 203it [02:01,  1.80it/s]Extractor Predicting: 204it [02:01,  1.77it/s]Extractor Predicting: 205it [02:02,  1.77it/s]Extractor Predicting: 206it [02:02,  1.85it/s]Extractor Predicting: 207it [02:03,  1.82it/s]Extractor Predicting: 208it [02:04,  1.85it/s]Extractor Predicting: 209it [02:04,  1.82it/s]Extractor Predicting: 210it [02:05,  1.82it/s]Extractor Predicting: 211it [02:05,  1.82it/s]Extractor Predicting: 212it [02:06,  1.87it/s]Extractor Predicting: 213it [02:06,  1.89it/s]Extractor Predicting: 214it [02:07,  1.87it/s]Extractor Predicting: 215it [02:07,  1.92it/s]Extractor Predicting: 216it [02:08,  1.92it/s]Extractor Predicting: 217it [02:08,  1.87it/s]Extractor Predicting: 218it [02:09,  1.85it/s]Extractor Predicting: 219it [02:09,  1.87it/s]Extractor Predicting: 220it [02:10,  1.88it/s]Extractor Predicting: 221it [02:11,  1.89it/s]Extractor Predicting: 222it [02:11,  1.94it/s]Extractor Predicting: 223it [02:12,  1.88it/s]Extractor Predicting: 224it [02:12,  1.89it/s]Extractor Predicting: 225it [02:13,  1.88it/s]Extractor Predicting: 226it [02:13,  1.88it/s]Extractor Predicting: 227it [02:14,  1.92it/s]Extractor Predicting: 228it [02:14,  1.91it/s]Extractor Predicting: 229it [02:15,  1.80it/s]Extractor Predicting: 230it [02:15,  1.75it/s]Extractor Predicting: 231it [02:16,  1.67it/s]Extractor Predicting: 232it [02:17,  1.62it/s]Extractor Predicting: 233it [02:17,  1.61it/s]Extractor Predicting: 234it [02:18,  1.59it/s]Extractor Predicting: 235it [02:19,  1.60it/s]Extractor Predicting: 236it [02:19,  1.60it/s]Extractor Predicting: 237it [02:20,  1.56it/s]Extractor Predicting: 238it [02:21,  1.55it/s]Extractor Predicting: 239it [02:21,  1.56it/s]Extractor Predicting: 240it [02:22,  1.56it/s]Extractor Predicting: 241it [02:23,  1.57it/s]Extractor Predicting: 242it [02:23,  1.60it/s]Extractor Predicting: 243it [02:24,  1.54it/s]Extractor Predicting: 244it [02:24,  1.58it/s]Extractor Predicting: 245it [02:25,  1.58it/s]Extractor Predicting: 246it [02:26,  1.60it/s]Extractor Predicting: 247it [02:26,  1.55it/s]Extractor Predicting: 248it [02:27,  1.55it/s]Extractor Predicting: 249it [02:28,  1.49it/s]Extractor Predicting: 250it [02:28,  1.51it/s]Extractor Predicting: 251it [02:29,  1.53it/s]Extractor Predicting: 252it [02:30,  1.55it/s]Extractor Predicting: 253it [02:30,  1.57it/s]Extractor Predicting: 254it [02:31,  1.55it/s]Extractor Predicting: 255it [02:32,  1.56it/s]Extractor Predicting: 256it [02:32,  1.58it/s]Extractor Predicting: 257it [02:33,  1.61it/s]Extractor Predicting: 258it [02:33,  1.63it/s]Extractor Predicting: 259it [02:34,  1.65it/s]Extractor Predicting: 260it [02:34,  1.68it/s]Extractor Predicting: 261it [02:35,  1.67it/s]Extractor Predicting: 262it [02:36,  1.68it/s]Extractor Predicting: 263it [02:36,  1.69it/s]Extractor Predicting: 264it [02:37,  1.71it/s]Extractor Predicting: 265it [02:38,  1.61it/s]Extractor Predicting: 266it [02:38,  1.66it/s]Extractor Predicting: 267it [02:39,  1.70it/s]Extractor Predicting: 268it [02:39,  1.68it/s]Extractor Predicting: 269it [02:40,  1.70it/s]Extractor Predicting: 270it [02:40,  1.68it/s]Extractor Predicting: 271it [02:41,  1.68it/s]Extractor Predicting: 272it [02:42,  1.67it/s]Extractor Predicting: 273it [02:42,  1.67it/s]Extractor Predicting: 274it [02:43,  1.62it/s]Extractor Predicting: 275it [02:43,  1.66it/s]Extractor Predicting: 276it [02:44,  1.67it/s]Extractor Predicting: 277it [02:45,  1.66it/s]Extractor Predicting: 278it [02:45,  1.62it/s]Extractor Predicting: 279it [02:46,  1.66it/s]Extractor Predicting: 280it [02:47,  1.65it/s]Extractor Predicting: 281it [02:47,  1.68it/s]Extractor Predicting: 282it [02:48,  1.63it/s]Extractor Predicting: 283it [02:48,  1.65it/s]Extractor Predicting: 284it [02:49,  1.66it/s]Extractor Predicting: 285it [02:50,  1.63it/s]Extractor Predicting: 286it [02:50,  1.63it/s]Extractor Predicting: 287it [02:51,  1.67it/s]Extractor Predicting: 288it [02:51,  1.67it/s]Extractor Predicting: 289it [02:52,  1.66it/s]Extractor Predicting: 290it [02:53,  1.66it/s]Extractor Predicting: 291it [02:53,  1.63it/s]Extractor Predicting: 292it [02:54,  1.65it/s]Extractor Predicting: 293it [02:54,  1.64it/s]Extractor Predicting: 294it [02:55,  1.65it/s]Extractor Predicting: 295it [02:56,  1.66it/s]Extractor Predicting: 296it [02:56,  1.66it/s]Extractor Predicting: 297it [02:57,  1.68it/s]Extractor Predicting: 298it [02:57,  1.63it/s]Extractor Predicting: 299it [02:58,  1.66it/s]Extractor Predicting: 300it [02:59,  1.66it/s]Extractor Predicting: 301it [02:59,  1.49it/s]Extractor Predicting: 302it [03:00,  1.54it/s]Extractor Predicting: 303it [03:01,  1.61it/s]Extractor Predicting: 304it [03:01,  1.63it/s]Extractor Predicting: 305it [03:02,  1.69it/s]Extractor Predicting: 306it [03:02,  1.68it/s]Extractor Predicting: 307it [03:03,  1.65it/s]Extractor Predicting: 308it [03:04,  1.65it/s]Extractor Predicting: 309it [03:04,  1.68it/s]Extractor Predicting: 310it [03:05,  1.64it/s]Extractor Predicting: 311it [03:05,  1.64it/s]Extractor Predicting: 312it [03:06,  1.65it/s]Extractor Predicting: 313it [03:07,  1.67it/s]Extractor Predicting: 314it [03:07,  1.67it/s]Extractor Predicting: 315it [03:08,  1.70it/s]Extractor Predicting: 316it [03:08,  1.65it/s]Extractor Predicting: 317it [03:09,  1.65it/s]Extractor Predicting: 318it [03:10,  1.72it/s]Extractor Predicting: 319it [03:10,  1.71it/s]Extractor Predicting: 320it [03:11,  1.75it/s]Extractor Predicting: 321it [03:11,  1.72it/s]Extractor Predicting: 322it [03:12,  1.69it/s]Extractor Predicting: 323it [03:12,  1.68it/s]Extractor Predicting: 324it [03:13,  1.67it/s]Extractor Predicting: 325it [03:14,  1.64it/s]Extractor Predicting: 326it [03:14,  1.66it/s]Extractor Predicting: 327it [03:15,  1.64it/s]Extractor Predicting: 328it [03:16,  1.63it/s]Extractor Predicting: 329it [03:16,  1.59it/s]Extractor Predicting: 330it [03:17,  1.58it/s]Extractor Predicting: 331it [03:17,  1.60it/s]Extractor Predicting: 332it [03:18,  1.65it/s]Extractor Predicting: 333it [03:19,  1.64it/s]Extractor Predicting: 334it [03:19,  1.64it/s]Extractor Predicting: 335it [03:20,  1.61it/s]Extractor Predicting: 336it [03:21,  1.61it/s]Extractor Predicting: 337it [03:21,  1.62it/s]Extractor Predicting: 338it [03:22,  1.63it/s]Extractor Predicting: 339it [03:22,  1.63it/s]Extractor Predicting: 340it [03:23,  1.68it/s]Extractor Predicting: 341it [03:24,  1.63it/s]Extractor Predicting: 342it [03:24,  1.67it/s]Extractor Predicting: 343it [03:25,  1.62it/s]Extractor Predicting: 344it [03:25,  1.65it/s]Extractor Predicting: 345it [03:26,  1.62it/s]Extractor Predicting: 346it [03:27,  1.66it/s]Extractor Predicting: 347it [03:27,  1.66it/s]Extractor Predicting: 348it [03:28,  1.69it/s]Extractor Predicting: 349it [03:28,  1.61it/s]Extractor Predicting: 350it [03:29,  1.56it/s]Extractor Predicting: 351it [03:30,  1.56it/s]Extractor Predicting: 352it [03:30,  1.59it/s]Extractor Predicting: 353it [03:31,  1.59it/s]Extractor Predicting: 354it [03:32,  1.61it/s]Extractor Predicting: 355it [03:32,  1.60it/s]Extractor Predicting: 356it [03:33,  1.64it/s]Extractor Predicting: 357it [03:33,  1.62it/s]Extractor Predicting: 358it [03:34,  1.59it/s]Extractor Predicting: 359it [03:35,  1.58it/s]Extractor Predicting: 360it [03:35,  1.55it/s]Extractor Predicting: 361it [03:36,  1.60it/s]Extractor Predicting: 362it [03:37,  1.63it/s]Extractor Predicting: 363it [03:37,  1.62it/s]Extractor Predicting: 364it [03:38,  1.65it/s]Extractor Predicting: 365it [03:38,  1.65it/s]Extractor Predicting: 366it [03:39,  1.58it/s]Extractor Predicting: 367it [03:40,  1.59it/s]Extractor Predicting: 368it [03:40,  1.58it/s]Extractor Predicting: 369it [03:41,  1.60it/s]Extractor Predicting: 370it [03:42,  1.59it/s]Extractor Predicting: 371it [03:42,  1.62it/s]Extractor Predicting: 372it [03:43,  1.64it/s]Extractor Predicting: 373it [03:43,  1.67it/s]Extractor Predicting: 374it [03:44,  1.64it/s]Extractor Predicting: 375it [03:45,  1.63it/s]Extractor Predicting: 376it [03:45,  1.65it/s]Extractor Predicting: 377it [03:46,  1.65it/s]Extractor Predicting: 378it [03:46,  1.66it/s]Extractor Predicting: 379it [03:47,  1.68it/s]Extractor Predicting: 380it [03:48,  1.68it/s]Extractor Predicting: 381it [03:48,  1.69it/s]Extractor Predicting: 382it [03:49,  1.64it/s]Extractor Predicting: 383it [03:49,  1.62it/s]Extractor Predicting: 384it [03:50,  1.65it/s]Extractor Predicting: 385it [03:51,  1.67it/s]Extractor Predicting: 386it [03:51,  1.70it/s]Extractor Predicting: 387it [03:52,  1.72it/s]Extractor Predicting: 388it [03:52,  1.68it/s]Extractor Predicting: 389it [03:53,  1.68it/s]Extractor Predicting: 390it [03:54,  1.67it/s]Extractor Predicting: 391it [03:54,  1.65it/s]Extractor Predicting: 392it [03:55,  1.66it/s]Extractor Predicting: 393it [03:55,  1.67it/s]Extractor Predicting: 394it [03:56,  1.69it/s]Extractor Predicting: 395it [03:57,  1.63it/s]Extractor Predicting: 396it [03:57,  1.66it/s]Extractor Predicting: 397it [03:58,  1.68it/s]Extractor Predicting: 398it [03:58,  1.65it/s]Extractor Predicting: 399it [03:59,  1.65it/s]Extractor Predicting: 400it [04:00,  1.61it/s]Extractor Predicting: 401it [04:00,  1.64it/s]Extractor Predicting: 402it [04:01,  1.50it/s]Extractor Predicting: 403it [04:02,  1.54it/s]Extractor Predicting: 404it [04:02,  1.60it/s]Extractor Predicting: 405it [04:03,  1.63it/s]Extractor Predicting: 406it [04:03,  1.66it/s]Extractor Predicting: 407it [04:04,  1.65it/s]Extractor Predicting: 408it [04:05,  1.67it/s]Extractor Predicting: 409it [04:05,  1.71it/s]Extractor Predicting: 410it [04:06,  1.71it/s]Extractor Predicting: 411it [04:06,  1.68it/s]Extractor Predicting: 412it [04:07,  1.71it/s]Extractor Predicting: 413it [04:07,  1.70it/s]Extractor Predicting: 414it [04:08,  1.70it/s]Extractor Predicting: 415it [04:09,  1.74it/s]Extractor Predicting: 416it [04:09,  1.74it/s]Extractor Predicting: 417it [04:10,  1.67it/s]Extractor Predicting: 418it [04:10,  1.70it/s]Extractor Predicting: 419it [04:11,  1.69it/s]Extractor Predicting: 420it [04:12,  1.64it/s]Extractor Predicting: 421it [04:12,  1.66it/s]Extractor Predicting: 422it [04:13,  1.66it/s]Extractor Predicting: 423it [04:13,  1.67it/s]Extractor Predicting: 424it [04:14,  1.68it/s]Extractor Predicting: 425it [04:14,  1.89it/s]Extractor Predicting: 425it [04:14,  1.67it/s]
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at albert-large-v2 were not used when initializing AlbertModel: ['predictions.LayerNorm.weight', 'predictions.decoder.bias', 'predictions.dense.bias', 'predictions.decoder.weight', 'predictions.dense.weight', 'predictions.bias', 'predictions.LayerNorm.bias']
- This IS expected if you are initializing AlbertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing AlbertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
{
  "path_pred": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_single_is_eval_False.jsonl",
  "path_gold": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_single_is_eval_False.jsonl",
  "precision": 0.2655643421998562,
  "recall": 0.18132731199685842,
  "score": 0.21550667989032143,
  "mode": "single",
  "limit": 0,
  "path_results": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/results_single_is_eval_False.json"
}
{'run_eval': {'path_model': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5', 'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'mode': 'multi', 'model_size': 'large', 'is_eval': False, 'limit': 0}}
{'predict': {'path_in': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_multi_is_eval_False.jsonl', 'path_out': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_multi_is_eval_False.jsonl'}}
predict vocab size: 1602
{'get_model': {'config': {'cased': False, 'token_emb_dim': 100, 'char_encoder': 'lstm', 'char_emb_dim': 30, 'tag_emb_dim': 50, 'hidden_dim': 200, 'num_layers': 3, 'max_depth': None, 'crf': None, 'loss_reduction': 'sum', 'dropout': 0.5, 'lr': 0.001, 'optimizer': 'adam', 'maxlen': None, 'vocab_size': 1702, 'vocab_file': None, 'ner_tag_vocab_size': 64, 're_tag_vocab_size': 250, 'tag_form': 'iob2', 'device': 'cuda', 'lm_emb_dim': 1024, 'lm_emb_path': 'albert-large-v2', 'pos_emb_dim': 0, 'head_emb_dim': 384, 'warm_steps': 1000, 'grad_period': 1}}}
albert-large-v2 is not file, try load as bert model.
albert-large-v2 loaded successfully.
Note it only supports default options now, i.e.: 
  layers='-1,-2,-3,-4', use_scalar_mix=True, pooling_operation="mean"
reading pretrained wv from outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/data/predict.txt
Extractor Predicting: 0it [00:00, ?it/s]Extractor Predicting: 1it [00:00,  1.66it/s]Extractor Predicting: 2it [00:01,  1.56it/s]Extractor Predicting: 3it [00:01,  1.48it/s]Extractor Predicting: 4it [00:02,  1.50it/s]Extractor Predicting: 5it [00:03,  1.50it/s]Extractor Predicting: 6it [00:03,  1.55it/s]Extractor Predicting: 7it [00:04,  1.82it/s]Extractor Predicting: 7it [00:04,  1.64it/s]
{
  "path_pred": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_out_filter_multi_is_eval_False.jsonl",
  "path_gold": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/pred_in_multi_is_eval_False.jsonl",
  "precision": 0.38636363636363635,
  "recall": 0.10828025477707007,
  "score": 0.16915422885572143,
  "mode": "multi",
  "limit": 0,
  "path_results": "outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter5/results_multi_is_eval_False.json"
}
{'eval_best': {'path_test': 'zero_rte/fewrel/unseen_15_seed_3/test.jsonl', 'save_dir': 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/', 'labels': ['characters', 'competition class', 'country of citizenship', 'father', 'field of work', 'heritage designation', 'instrument', 'licensed to broadcast to', 'located in the administrative territorial entity', 'occupant', 'occupation', 'original broadcaster', 'performer', 'position played on team / speciality', 'record label'], 'num_iter': 5, 'limit': 5000}}
Traceback (most recent call last):
  File "wrapper.py", line 811, in <module>
    Fire()
  File "/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/cto_studio/xuting/miniconda3/envs/table_v1/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "wrapper.py", line 654, in main_dual
    eval_best(path_test=path_test, save_dir=save_dir, labels=labels_test, num_iter=num_iter, limit=limit)
  File "wrapper.py", line 711, in eval_best
    with open(path_results) as f:
FileNotFoundError: [Errno 2] No such file or directory: 'outputs/wrapper/fewrel_rl_all_rsFalse_nbrel_withTrainFalse_synthetic_large/unseen_15_seed_3/extractor/iter1/results_single_is_eval_True_limit5000.json'
